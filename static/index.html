<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Biomass Explorer</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-minimap/3.6.1/Control.MiniMap.css" />
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div id="sidebar">
    <div style="display:flex; align-items:center; gap:10px;">
        <span style="font-size: 1.5rem;">üõ∞Ô∏è</span>
        <h2 style="margin:0; font-size: 1.2rem;">Biomass Explorer</h2>
    </div>

    <div class="card">
        <h3>1. Query Configuration</h3>
        <label>Field Identifier</label>
        <input type="text" id="field_id" placeholder="e.g. Field_1">
        <label>Observation Window</label>
        <div style="display: flex; gap: 5px;"><input type="date" id="start_date"><input type="date" id="end_date"></div>
        
        <label>Spectral Indices</label>
        <div class="indices-grid">
            <div class="checkbox-item"><input type="checkbox" name="idx" value="NDVI"> NDVI</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="GNDVI"> GNDVI</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="EVI"> EVI</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="MSAVI2"> MSAVI2</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="SAVI"> SAVI</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="OSAVI"> OSAVI</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="NDRE"> NDRE</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="REIP"> REIP</div>
            <div class="checkbox-item"><input type="checkbox" name="idx" value="NDWI"> NDWI</div>
        </div>
        
        <label>Area of Interest (GeoJSON)</label>
        <textarea id="geojson_input" style="height:60px;" placeholder="[[[lon, lat], ...]]]"></textarea>
        <button class="primary" id="btn-search" onclick="startAnalysis()">üîç SEARCH COLLECTION</button>
    </div>

    <div id="result-card" class="card" style="display:none;">
        <h3>2. Analysis Dashboard</h3>
        <button class="outline" onclick="zoomToAOI()">üéØ RECENTER ON AOI</button>
        <div id="dates-container"></div>
        <button class="secondary" id="btn-load" onclick="loadSelectedLayers()">üåç LOAD SELECTED MAPS</button>
    </div>

    <div id="status">Ready.</div>
</div>

<div id="map">
    <div id="legend-panel">
        <div id="legend-tabs"></div>
        <div id="leg-content">
            <div class="full-name" id="full-name">Index Full Name</div>
            <div class="formula-box" id="leg-formula">Formula</div>
            <p id="leg-desc" style="font-size:0.8rem; color:#64748b; margin-bottom:15px;"></p>
            <div id="leg-gradient" class="legend-gradient"></div>
            <div class="leg-labels"><span id="leg-min">Min</span><span id="leg-max">Max</span></div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-minimap/3.6.1/Control.MiniMap.min.js"></script>

<script src="/static/script.js"></script>

</body>
</html>